<!DOCTYPE html><html><head><style>
.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #808080 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0040D0 } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */

.wikilink {
    text-decoration: none;
    background-color: #F6F0AC;
    border-radius: 4px;
    text-shadow: 1px 1px white;
    padding-left: 3px;
    padding-right: 3px;
    font-family: monospace;
}

dt {
    margin-top: 1em;
    font-family: monospace;
    font-size: 110%;
    font-weight: bold;
}

body {
    color: #303030;
    font-size: 14px;
    line-height: 1.42857;
    margin: 50px;
    padding: 50px;
}

pre {
    background: #F5F5F5;
    border: 1px solid #C0C0C0;
    border-radius: 3px;
    padding: 5px 10px;
}

code {
    background: #E8E8E8;
    border: 0px solid #C0C0C0;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 90%;
}

</style></head><title>The tab programming language.</title><body>
<h1 id="the-tab-cookbook">The tab cookbook</h1>
<p>This is an example list of useful <code>tab</code> programs.</p>
<h4 id="count-the-number-of-lines-in-a-file">Count the number of lines in a file:</h4>
<div class="codehilite"><pre>count<span class="o">(</span>@<span class="o">)</span>
</pre></div>


<h4 id="output-the-longest-line-in-a-file">Output the longest line in a file:</h4>
<div class="codehilite"><pre>max<span class="o">([</span> count<span class="o">(</span>@<span class="o">)</span>, @ <span class="o">])</span>~1
</pre></div>


<h4 id="output-the-three-longest-lines-in-a-file">Output the three longest lines in a file:</h4>
<div class="codehilite"><pre><span class="o">[</span> @~1 : sort<span class="o">([</span> count<span class="o">(</span>@<span class="o">)</span>, @ <span class="o">])[</span>-3,-1<span class="o">]</span> <span class="o">]</span>
</pre></div>


<h4 id="output-the-most-common-english-words-in-a-file">Output the most common English words in a file:</h4>
<div class="codehilite"><pre><span class="nv">freq</span><span class="o">={</span> @ -&gt; sum.1 : :<span class="o">[</span>grep<span class="o">(</span>@,<span class="s2">&quot;[A-Za-z0-9]+&quot;</span><span class="o">)]</span> <span class="o">}</span>, <span class="o">(</span>sort.flip.freq<span class="o">)</span>~-1~1
</pre></div>


<h4 id="output-the-counts-of-top-ten-most-common-bytes-in-a-file">Output the counts of top ten most common bytes in a file:</h4>
<div class="codehilite"><pre><span class="nv">freq</span><span class="o">={</span> @ -&gt; sum.1 : :<span class="o">[</span>bytes.@<span class="o">]</span> <span class="o">}</span>, <span class="o">[</span> string.array.@~1, @~0 : <span class="o">(</span>sort.flip.freq<span class="o">)[</span>-10,-1<span class="o">]</span> <span class="o">]</span>
</pre></div>


<h4 id="the-histogram-of-english-word-frequencies-by-word-lengths">The histogram of English word frequencies by word lengths:</h4>
<div class="codehilite"><pre>freq.<span class="o">{</span> count.@ -&gt; sum.1 : :<span class="o">[</span>grep<span class="o">(</span>@,<span class="s2">&quot;[A-Za-z0-9]+&quot;</span><span class="o">)]</span> <span class="o">}</span>, sort.freq
</pre></div>


<h4 id="same-histogram-but-also-with-the-words-themselves">Same histogram, but also with the words themselves:</h4>
<div class="codehilite"><pre><span class="nv">freq</span><span class="o">={</span> count.@ -&gt; sum.1, <span class="o">{</span>tolower.@<span class="o">}</span> : :<span class="o">[</span>grep<span class="o">(</span>@,<span class="s2">&quot;[A-Za-z0-9]+&quot;</span><span class="o">)]</span> <span class="o">}</span>,
def f first.@,
def s second.@,
sort.<span class="o">[</span> f.@, f.s.@, join<span class="o">(</span>f.s.s.@, <span class="s2">&quot;,&quot;</span><span class="o">)</span> : freq<span class="o">]</span>
</pre></div>


<h4 id="all-english-words-following-the-word-the">All English words following the word &lsquo;the&rsquo;:</h4>
<div class="codehilite"><pre>?<span class="o">[</span> <span class="o">(</span>tolower.first.@<span class="o">)</span> <span class="o">==</span> <span class="s2">&quot;the&quot;</span>, second.@ : pairs<span class="o">(</span> :<span class="o">[</span>grep<span class="o">(</span>@,<span class="s2">&quot;[A-Za-z0-9]+&quot;</span><span class="o">)]</span> <span class="o">)</span> <span class="o">]</span>
</pre></div>


<h4 id="output-four-random-lines-from-a-file">Output four random lines from a file:</h4>
<div class="codehilite"><pre>sample<span class="o">(</span>4, @<span class="o">)</span>
</pre></div>


<h4 id="check-if-there-is-an-empty-line-among-four-random-lines-from-a-file">Check if there is an empty line among four random lines from a file:</h4>
<div class="codehilite"><pre>sum<span class="o">([</span> count<span class="o">(</span>@<span class="o">)</span> <span class="o">==</span> <span class="m">0</span> : sample<span class="o">(</span>4, @<span class="o">)</span> <span class="o">])</span> &gt; 0
</pre></div>


<h4 id="sample-four-lines-from-filetxt-one-hundred-times-and-output-the-histogram-of-number-of-empty-lines">Sample four lines from <code>file.txt</code> one hundred times and output the histogram of number of empty lines:</h4>
<div class="codehilite"><pre>def empties sum<span class="o">([</span> count<span class="o">(</span>@<span class="o">)</span> <span class="o">==</span> <span class="m">0</span> : sample<span class="o">(</span>4, @<span class="o">)</span> <span class="o">])</span>,
<span class="o">{</span> empties.open.<span class="s2">&quot;file.txt&quot;</span> -&gt; sum.1 : count<span class="o">(</span>100<span class="o">)</span> <span class="o">}</span>
</pre></div>


<h4 id="a-sine-and-cose-table">A sine and cose table:</h4>
<div class="codehilite"><pre><span class="o">[</span> sin.@, cos.@ : count<span class="o">(</span>0.0, 2*pi<span class="o">()</span>, pi<span class="o">()</span>/8<span class="o">)</span> <span class="o">]</span>
</pre></div>


<hr>
<p>For the next few examples let&rsquo;s use an input file that looks something like this:</p>
<div class="codehilite"><pre>1948    12  11  24
1948    12  12  19
1948    12  13  -74
1948    12  14  -56
</pre></div>


<p>The first three fields are the year, month and day. The fourth field is the daily max temperature in increments of 0.1 degrees Celcius.</p>
<hr>
<h4 id="the-average-mean-of-the-temperature-aggregated-by-year">The average (mean) of the temperature, aggregated by year:</h4>
<div class="codehilite"><pre><span class="o">{</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, x~0 -&gt; avg.real.x~3 <span class="o">}</span>
</pre></div>


<h4 id="as-above-except-also-with-the-median">As above, except also with the median:</h4>
<div class="codehilite"><pre><span class="nv">data</span><span class="o">={</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, <span class="nv">v</span><span class="o">=</span>real.x~3, x~0 -&gt; avg.v, sort.v <span class="o">}</span>, <span class="o">[</span> @~0, @~1~0, @~1~1~0.5 : data <span class="o">]</span>
</pre></div>


<h4 id="a-histogram-of-the-temperature-grouped-by-buckets-of-ten-degrees">A histogram of the temperature, grouped by buckets of ten degrees:</h4>
<div class="codehilite"><pre>sort.<span class="o">{</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, 100*int<span class="o">(</span>real<span class="o">(</span>x~3<span class="o">)</span>/100<span class="o">)</span> -&gt; sum.1 <span class="o">}</span>
</pre></div>


<h4 id="check-if-the-distribution-of-temperature-matches-a-sampled-normal-distribution">Check if the distribution of temperature matches a (sampled) normal distribution:</h4>
<div class="codehilite"><pre><span class="nv">temps</span><span class="o">=[</span>. real.cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span>,3<span class="o">)</span> .<span class="o">]</span>,
<span class="nv">u</span><span class="o">=</span>mean.temps, <span class="nv">s</span><span class="o">=</span>stddev.temps, <span class="nv">a</span><span class="o">=</span>min.temps, <span class="nv">b</span><span class="o">=</span>max.temps,
sort.<span class="o">{</span> bucket<span class="o">(</span>@~0, a, b, 5<span class="o">)</span> -&gt; sum.@~1, sum.@~2 :
       :seq<span class="o">([</span> @, 1, <span class="m">0</span> : temps <span class="o">]</span>, <span class="o">[</span> normal<span class="o">(</span>u,s<span class="o">)</span>, 0, <span class="m">1</span> : count.count.temps <span class="o">])</span> <span class="o">}</span>
</pre></div>


<h4 id="find-temperature-outliers-more-than-3-standard-deviations-away-from-mean-and-group-them-by-year">Find temperature outliers (more than 3 standard deviations away from mean) and group them by year:</h4>
<div class="codehilite"><pre>temps=[. x=cut(@,&quot;\t&quot;), uint.x~0, real.x~3 .],
sd=stddev.[@~1 : temps],
{ @~0 -&gt; sum.1 : ?[@~1 &gt; 3*sd, @ : temps] }
</pre></div>


<h4 id="find-years-with-spotty-temperature-records-where-the-number-of-measurements-taken-is-more-than-one-standard-deviation-away-from-the-average-year">Find years with spotty temperature records &ndash; where the number of measurements taken is more than one standard deviation away from the average year:</h4>
<div class="codehilite"><pre><span class="nv">y_n</span><span class="o">={</span> uint.cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span>,0<span class="o">)</span> -&gt; sum.1 <span class="o">}</span>,
<span class="nv">u</span><span class="o">=</span>mean.second.y_n, <span class="nv">sd</span><span class="o">=</span>stddev.second.y_n,
?<span class="o">[</span> abs<span class="o">(</span>@~1 - u<span class="o">)</span> &gt; sd, @~0 : y_n <span class="o">]</span>
</pre></div>


<h4 id="group-temperatures-by-year-and-month-and-find-the-mean-and-median-for-september-1998">Group temperatures by year and month, and find the mean and median for September 1998:</h4>
<div class="codehilite"><pre><span class="nv">t</span><span class="o">={</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, uint.x~1 -&gt; map<span class="o">(</span>uint.x~0, sort.real.x~3<span class="o">)</span> <span class="o">}</span>~9~1998, mean.t, t~0.5
</pre></div>


<h4 id="same-as-above-but-compare-it-to-the-mean-and-median-across-all-septembers">Same as above, but compare it to the mean and median across all Septembers:</h4>
<div class="codehilite"><pre><span class="nv">t</span><span class="o">={</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, uint.x~1 -&gt; map<span class="o">(</span>uint.x~0, sort.real.x~3<span class="o">)</span> <span class="o">}</span>~9,
mean.t~1998, t~1998~0.5,
mean.flatten.second.t, <span class="o">(</span>sort.flatten.second.t<span class="o">)</span>~0.5
</pre></div>


<h4 id="average-september-temperatures-by-year">Average September temperatures by year:</h4>
<div class="codehilite"><pre>sort.map.?<span class="o">[</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, <span class="o">(</span>uint.x~1<span class="o">)</span> <span class="o">==</span> 9, uint.x~0, avg.real.x~3 <span class="o">]</span>
</pre></div>


<dl>
<dd>pipe the output to <code>gnuplot -p -e "plot '-' with lines"</code> to see a graph</dd>
</dl>
<h4 id="moving-average-of-september-temperatures-over-10-previous-years">Moving average of September temperatures, over 10 previous years:</h4>
<div class="codehilite"><pre><span class="nv">t</span><span class="o">=</span>sort.map.?<span class="o">[</span> <span class="nv">x</span><span class="o">=</span>cut<span class="o">(</span>@,<span class="s2">&quot;\t&quot;</span><span class="o">)</span>, <span class="o">(</span>uint.x~1<span class="o">)</span> <span class="o">==</span> 9, uint.x~0, avg.real.x~3 <span class="o">]</span>,
def arr_to_seq <span class="o">[</span>@:@<span class="o">]</span>,
sort.<span class="o">{</span> @~<span class="o">(</span>-1<span class="o">)</span>~0 -&gt; avg.second.arr_to_seq.@ : ngrams<span class="o">(</span>arr_to_seq.t, 10<span class="o">)</span> <span class="o">}</span>
</pre></div></body></html>
